-- ÉTAPE 1: SUPPRIME L'ANCIENNE BASE DE DONNÉES
DROP DATABASE IF EXISTS airejeux_db;

-- ÉTAPE 2: CRÉE LA NOUVELLE BASE DE DONNÉES
CREATE DATABASE airejeux_db CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci;
USE airejeux_db;

-- ÉTAPE 3: CRÉE LES TABLES AVEC LES BONS TYPES (BIGINT)
CREATE TABLE `coordonnees` (
  `id` BIGINT NOT NULL AUTO_INCREMENT,
  `latitude` varchar(100) NOT NULL,
  `longitude` varchar(100) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3 COLLATE=utf8mb3_general_ci;

CREATE TABLE `jeux` (
  `id` BIGINT NOT NULL AUTO_INCREMENT,
  `nom` varchar(100) NOT NULL,
  `quantite` int(11) NOT NULL,
  `description` varchar(200) DEFAULT NULL,
  `coordonnees_id` BIGINT NOT NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `jeux_ibfk_1` FOREIGN KEY (`coordonnees_id`) REFERENCES `coordonnees` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3 COLLATE=utf8mb3_general_ci;

CREATE TABLE `utilisateur` (
  `id` BIGINT NOT NULL AUTO_INCREMENT,
  `nom` varchar(255) DEFAULT NULL,
  `prenom` varchar(255) DEFAULT NULL,
  `mail` varchar(255) DEFAULT NULL,
  `password` varchar(255) DEFAULT NULL,
  `username` varchar(255) DEFAULT NULL,
  `role` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3 COLLATE=utf8mb3_general_ci;

CREATE TABLE `reservation` (
  `id` BIGINT NOT NULL AUTO_INCREMENT,
  `utilisateur_id` BIGINT NOT NULL,
  `jeux_id` BIGINT NOT NULL,
  `reservation` int(11) NOT NULL DEFAULT 0,
  `booking_date` date NOT NULL,
  `start_time` time NOT NULL,
  `end_time` time NOT NULL,
  `quantity` int(11) NOT NULL DEFAULT 1,
  `status` varchar(20) DEFAULT 'PENDING',
  `notes` text DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  PRIMARY KEY (`id`),
  KEY `idx_utilisateur_id` (`utilisateur_id`),
  KEY `idx_jeux_id` (`jeux_id`),
  CONSTRAINT `reservation_ibfk_1` FOREIGN KEY (`utilisateur_id`) REFERENCES `utilisateur` (`id`),
  CONSTRAINT `reservation_ibfk_2` FOREIGN KEY (`jeux_id`) REFERENCES `jeux` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3 COLLATE=utf8mb3_general_ci;

-- ÉTAPE 4: INSÈRE LES DONNÉES (CORRIGÉES)
INSERT INTO `coordonnees`(id, latitude, longitude) VALUES
(1,"47.3688493669","0.6941214246"),(2,"47.3744501733","0.7126998075"),(3,"47.3744437279","0.7131432662"),(4,"47.3675794513","0.6744450182"),(5,"47.3792813876","0.6994542609"),(6,"47.4409537306","0.6909285044"),(7,"47.3721145685","0.6836426088"),(8,"47.384453658","0.6850843419"),(9,"47.398356913","0.6782515219"),(10,"47.3626589557","0.7077088553"),(11,"47.3791790546","0.6993161247"),(12,"47.3926804428","0.6764424956"),(13,"47.3844195734","0.6853602338"),(14,"47.4026644244","0.6948004887"),(15,"47.3958162219","0.6834279831"),(16,"47.3762380951","0.6835342352"),(17,"47.4350734994","0.6801995588"),(18,"47.4354422123","0.6805692339"),(19,"47.4120183411","0.6896172078"),(20,"47.4036221742","0.7105261015"),(21,"47.3902526113","0.6683282103"),(22,"47.3801149681","0.7043955692"),(23,"47.3815189593","0.6948729264"),(24,"47.3682124268","0.7138944716"),(25,"47.4231748023","0.6794137512"),(26,"47.4215260593","0.6822599572"),(27,"47.385381194","0.6971195485"),(28,"47.3799398087","0.6994557391"),(29,"47.3749529872","0.7127412217"),(30,"47.4218630147","0.682069681"),(31,"47.3679036788","0.6738332298"),(32,"47.3677653354","0.6746922836"),(33,"47.3743831966","0.7076103631"),(34,"47.3768900502","0.7080003193"),(35,"47.3910150014","0.6836001248"),(36,"47.3944226377","0.6958037864"),(37,"47.3691065059","0.6927409072"),(38,"47.3725675045","0.694012894"),(39,"47.3677657094","0.6732131962"),(40,"47.426104452","0.691060465"),(41,"47.4331755043","0.7023652112"),(42,"47.3729593213","0.6790508603"),(43,"47.3883113145","0.7024344941"),(44,"47.3883540798","0.7026572049"),(45,"47.3880349253","0.6728426154"),(46,"47.3945335677","0.6957648811"),(47,"47.4020276383","0.7059524871"),(48,"47.3724838005","0.6801971308"),(49,"47.4248586909","0.6893677569"),(50,"47.3933364594","0.6984824909"),(51,"47.4396220706","0.6911326271"),(52,"47.4197344574","0.699199681"),(53,"47.3724068076","0.6940020564"),(54,"47.3811921616","0.6816164157"),(55,"47.3856491026","0.6938309883"),(56,"47.4208515308","0.6994347864"),(57,"47.3793805078","0.6991724545"),(58,"47.4021078547","0.7082751504"),(59,"47.3696361917","0.6847105262"),(60,"47.3855741123","0.6762301198"),(61,"47.3788628525","0.6926945711"),(62,"47.4246719138","0.6878628974"),(63,"47.4171504419","0.7033290917"),(64,"47.4202160888","0.6924128714"),(65,"47.4106796664","0.7131148864"),(66,"47.4080799545","0.6799448977"),(67,"47.3722778443","0.6858023073"),(68,"47.3678239789","0.6803928032"),(69,"47.3661534937","0.7094296694"),(70,"47.3623237319","0.7083250307"),(71,"47.3678775921","0.6733802174"),(72,"47.3933082843","0.6997657165"),(73,"47.3970158924","0.6909314208"),(74,"47.38687319","0.7016522407"),(75,"47.376135861","0.7126116975"),(76,"47.4178006082","0.6953435715"),(77,"47.4216101107","0.6821491204"),(78,"47.4022379422","0.706767248"),(79,"47.3718872806","0.7089325236"),(80,"47.3722386723","0.7087737337"),(81,"47.3721193775","0.6833865165"),(82,"47.3768002278","0.7078998339"),(83,"47.379919161","0.6992122212"),(84,"47.3732809835","0.697005027"),(85,"47.3719759911","0.7084063067"),(86,"47.3678950326","0.6730815522"),(87,"47.3744771336","0.7129062142"),(88,"47.4404332212","0.6908910929"),(89,"47.3846495715","0.6665007849"),(90,"47.3948028787","0.6791705998"),(91,"47.3813130107","0.6815362354"),(92,"47.3852254378","0.667671256"),(93,"47.3984221065","0.6784284279"),(94,"47.4022501163","0.7064081517"),(95,"47.4092496424","0.68678132"),(96,"47.379498334","0.6992933731"),(97,"47.3769959609","0.7077278031"),(98,"47.3844427548","0.6851945764"),(99,"47.3927809933","0.6763988308"),(100,"47.3934048655","0.6991270583"),(101,"47.3690221643","0.6923275769"),(102,"47.3738021784","0.6877899083"),(103,"47.397021866","0.6851353579"),(104,"47.3922707019","0.6766466293"),(105,"47.3820062287","0.669772666"),(106,"47.378800775","0.6751439072"),(107,"47.4364714308","0.6913480407"),(108,"47.3604226015","0.6951638242"),(109,"47.3731867659","0.6986286314"),(110,"47.3797613048","0.7106764546"),(111,"47.3862381042","0.6928606837"),(112,"47.4216669237","0.6819218455"),(113,"47.3791741066","0.6994662959");

INSERT INTO `jeux`(id, nom, quantite, description, coordonnees_id) VALUES
(1,"Vivaria, Duo et Biky",3,"LAC DE LA BERGEONNERIE",1),(2,"Ludokid à l\'Abeille",4,"JARDIN BOUZIGNAC",2),(3,"IXO",1,"JARDIN BOUZIGNAC",3),(4,"Mât à grimper",1,"PRAIRIE PARTIE PUBLIQUE",4),(5,"Double perchoir à Mini trampoline",6,"JARDIN MEFFRE",5),(6,"Ixo",1,"PARC COUSINERIE",6),(7,"Dino à Ness",5,"MAIL DAVID D\'ANGERS ET ABORDS",7),(8,"Le Club + Coquelicot",3,"JARDIN DES PREBENDES",8),(9,"Ecureuil + Canotier",2,"ILE SIMON",9),(10,"Aquatica à Balançoire mini M",4,"AIRE DE JEUX MONJOYEUX / FRANCOIS MANSART",10),(11,"Portique",4,"JARDIN MEFFRE",11),(12,"Minkar",1,"JARDIN DELPERIER",12),(13,"ADARA 2",1,"JARDIN DES PREBENDES",13),(14,"Val d\'Isère + Chaîne ludique + Etoile filante",3,"MATERNELLE PAUL BERT",14),(15,"Cloxx à Equilibre",4,"MATERNELLE PAUL LOUIS COURIER",15),(16,"Val d\'Isère + Tortue",2,"MATERNELLE JULES FERRY",16),(17,"Trampoline hexagonal",1,"PRIMAIRE PAUL FORT",17),(18,"Amazonia",1,"MATERNELLE PAUL FORT",18),(19,"Piccolo + Ressort double + Hippo",3,"MATERNELLE CROIX PASQUIER",19),(20,"UKI-BO à Fantôme",4,"MATERNELLE ROMAIN ROLLAND",20),(21,"Aquatica + Circuit équilibre",2,"MATERNELLE PAUL RACAULT",21),(22,"Amazonia + Duo + Circuit d\'équilibre",3,"MATERNELLE PAULINE KERGOMARD",22),(23,"Ile de Tarzan + Chenillon +Ver luisant",3,"MATERNELLE SUZANNE KLEBER",23),(24,"Val d\'Isère + Tortue + Chaîne ludique",3,"MATERNELLE MARCEL PAGNOL",24),(25,"Val d\'Isère à Tortue 2",5,"MATERNELLE JULES VERNE",25),(26,"Divers Petits",5,"JARDIN CHATEAUBRIAND",26),(27,"UKI-BO à Poutre zig-zag",4,"MATERNELLE MARIE CURIE",27),(28,"Gobi poisson (Jeux d\'eau)",7,"JARDIN MEFFRE",28),(29,"Jeu d\'eau",3,"JARDIN BOUZIGNAC",29),(30,"Portique",1,"JARDIN CHATEAUBRIAND",30),(31,"Naufrage",3,"PRAIRIE PARTIE PUBLIQUE",31),(32,"Sauvetage 2 (IXO)",1,"PRAIRIE PARTIE PUBLIQUE",32),(33,"Les éléphants et le cheval de cirque",3,"JARDIN GABRIELI",33),(34,"Kita dresden (jeu de cordage)",1,"BEAUJARDIN",34),(35,"Unimini Tixton",1,"SQUARE SOURDILLON",35),(36,"Toupie à Balancelle Poule 2",3,"MUSEE",36),(37,"IXO  et Gyrospire",2,"LAC DE LA BERGEONNERIE",37),(38,"Structure à Nid d\'oiseau",5,"SQUARE DAUMIER",38),(39,"Sauvetage (disque à ressort)",6,"PRAIRIE PARTIE PUBLIQUE",39),(40,"Pomme d\'Api à Spoutnik",8,"QUARTIER SAPAILLE",40),(41,"IXO",1,"MILLETIERE ZONE PAVILLONNAIRE",41),(42,"Mât à grimper",1,"JARDIN PERRAULT",42),(43,"Elément à Scooter",3,"SQUARE SALANCY",43),(44,"KANOPE",1,"SQUARE SALANCY",44),(45,"Ludokid + Coccinelles",3,"BORIS VIAN",45),(46,"Playbooster",1,"MUSEE",46),(47,"Téléphérique",1,"PARC STE-RADEGONDE",47),(48,"Cyclo + Duo + Quatro",3,"SQUARE RODIN",48),(49,"Kanopé + Nacelle",2,"QUARTIER SAPAILLE",49),(50,"Playsense à Floris 2",7,"JARDIN MIRABEAU",50),(51,"Vivaréa et Nacelles",4,"PARC COUSINERIE",51),(52,"Mosquito + ressorts + balançoires",6,"JARDIN DE LA GRENOUILLERE",52),(53,"Portique pultiple",1,"",53),(54,"Station à Jetski",5,"JARDIN BOYLESVE",54),(55,"Toupie + Marguerite + Jet ski",3,"PLACE DU 4 SEPTEMBRE 1870",55),(56,"Téléphérique double",1,"PARC DE LA GRENOUILLERE",56),(57,"Téléphérique",1,"JARDIN MEFFRE",57),(58,"Château + Moyen",2,"PARC STE-RADEGONDE",58),(59,"Mini jaune + balancelle poisson",2,"SQUARE JACQUES MONOD",59),(60,"3 Tours + Dragons",2,"MATERNELLE FRANCOIS RABELAIS",60),(61,"Pomme d\'Api + Ludokid",2,"MATERNELLE FERDINAND BUISSON",61),(62,"Piccolo",1,"MATERNELLE ALAIN",62),(63,"Val d\'Isère + Etoile filante",2,"MATERNELLE JEAN DE LA FONTAINE",63),(64,"Pomme d\'Api à Etoile filante",7,"MATERNELLE CHARLES PEGUY",64),(65,"Val d\'Isère + Chaîne ludique",2,"MATERNELLE ANDRE MAUROIS",65),(66,"Piccolo + Ressort double + Hippo",3,"MATERNELLE VICTOR HUGO",66),(67,"Amazonia + Pompe à bras",2,"MATERNELLE GEORGES DUHAMEL",67),(68,"Diabolo",1,"MATERNELLE SIMONE VEIL",68),(69,"Aquatica + Duo + Piste aux étoiles",3,"MATERNELLE ARTHUR RIMBAUD",69),(70,"Ile de Gulliver + Dauphin + Poney",3,"MATERNELLE MONTJOYEUX",70),(71,"Echouage 2 (structure à grimper)",1,"PRAIRIE PARTIE PUBLIQUE",71),(72,"AMAZONIA",1,"MATERNELLE MIRABEAU",72),(73,"Piccolo + Side-car",2,"MATERNELLE ANATOLE FRANCE",73),(74,"Pomme d\'Api à Fantôme",4,"MATERNELLE LES ABEILLES",74),(75,"Piccolo à Talk tube",4,"MATERNELLE GUSTAVE FLAUBERT",75),(76,"Jeu à rotation + Duo",2,"QUARTIER MONCONSEIL",76),(77,"Toboggan + ambulance + cygne",3,"JARDIN CHATEAUBRIAND",77),(78,"Diabolo aventure",1,"PARC DE SAINTE RADEGONDE",78),(79,"Corocord (pyracord double)",1,"AIRE DE JEUX BALZAC",79),(80,"kid O au petit train",4,"AIRE DE JEUX BALZAC",80),(81,"Tiboo",1,"MAIL DAVID D\'ANGERS ET ABORDS",81),(82,"La Tonnelle au Hamac",4,"BEAUJARDIN",82),(83,"Pyracord",1,"JARDIN MEFFRE",83),(84,"Ludokid à l\'Abeille",4,"SQUARE MENDELSSOHN",84),(85,"Pyracord",1,"SU13-47 AIRE DE JEUX BALZAC",85),(86,"Echouage (bateau avec vigie)",1,"PRAIRIE PARTIE PUBLIQUE",86),(87,"Portique double",1,"JARDIN BOUZIGNAC",87),(88,"Pyracord géant",1,"PARC COUSINERIE",88),(89,"Club3 + vaisseau + Draco",5,"ARBORETUM",89),(90,"Scooter + Toupie + Hamac",3,"CARROI AUX HERBES",90),(91,"Galaxy triton à Gemma",8,"JARDIN BOYLESVE",91),(92,"Portique à pompe à bras",7,"ARBORETUM",92),(93,"Portiques doubles et nacelle",3,"ILE SIMON",93),(94,"Pole ludique + portiques",5,"PARC STE-RADEGONDE",94),(95,"Unimini Tixton + Solo clay",2,"PARC COLBERT LA SOURCE",95),(96,"Etoie filante + IXO + Diabolo",3,"JARDIN MEFFRE",96),(97,"Jets magiques (jeu d\'eau)",4,"JARDIN BEAUJARDIN",97),(98,"Balançoires",2,"JARDIN DES PREBENDES",98),(99,"Structure Biibox à Scoot",4,"JARDIN DELPERIER",99),(100,"Balançoire",1,"JARDIN MIRABEAU",100),(101,"Roll Up à Aérospeed",5,"LAC DE LA BERGEONNERIE",101),(102,"Otaries + Moto + Coq",3,"SQUARE GAY LUSSAC",102),(103,"Structure cabane",1,"SQUARE COLLIN (GUINGETTE)",103),(104,"Pomme d\'Api à Buggy",5,"MATERNELLE CHARLES BOUTARD",104),(105,"Pomme d\'Api à Fantôme",4,"MATERNELLE JEAN MERMOZ",105),(106,"Hélicoptère + Abeille + Chenillon",3,"MATERNELLE GIRAUDEAU",106),(107,"Castello + Duo 1 et 2",3,"MATERNELLE ERNEST PEROCHON",107),(108,"Tema + Tiboo (2)",3,"MATERNELLE ALPHONSE DAUDET",108),(109,"Pomme d\'Api",1,"MATERNELLE ALFRED DE VIGNY",109),(110,"Pomme d\'Api à Canotier",4,"MATERNELLE RASPAIL",110),(111,"Vivaréa",1,"MATERNELLE GRECOURT",111),(112,"Pyracord + extension",1,"JARDIN CHATEAUBRIAND",112),(113,"Portique nacelle",1,"JARDIN MEFFRE",113);

-- ÉTAPE 5: INSÈRE L'UTILISATEUR ADMINISTRATEUR PAR DÉFAUT
-- Username: admin1
-- Password: admin123 (hash BCrypt généré par Spring Security)
-- Role: ROLE_ADMIN
INSERT INTO `utilisateur` (username, password, nom, prenom, mail, role) VALUES
('admin1', '$2a$10$HjuX4bKF3XvFMWsZnWVz9ePSPs1Dse3D32j98uWb0UkC4Te5IuoZO', 'Administrateur', 'Système', 'admin@airejeux.fr', 'ROLE_ADMIN');